{"ast":null,"code":"import { createAsyncThunk, createSlice, createAction } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { baseUrl } from \"../../../utils/baseurl\"; //reset/\n//const resetPost=createAction(\"category/reset\");\n//create post action \n\nexport const createPostAction = createAsyncThunk('post/created', async (post, _ref) => {\n  var _getState;\n\n  let {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = _ref;\n  //getuser token to be able to create post\n  const user = (_getState = getState()) === null || _getState === void 0 ? void 0 : _getState.users; // console.log(user)\n\n  const {\n    userAuth\n  } = user; // console.log(userAuth?.token); // got token in console. now pass it as header\n\n  const config = {\n    headers: {\n      Authorization: `Bearer ${userAuth === null || userAuth === void 0 ? void 0 : userAuth.token}`\n    }\n  };\n\n  try {\n    //http call\n    const {\n      data\n    } = await axios.post(`${baseUrl}/api/posts`, post, config); //dispatch action\n    // dispatch(resetPost);\n\n    return data;\n  } catch (error) {\n    var _error$resposne;\n\n    if (!(error !== null && error !== void 0 && error.resposne)) throw error;\n    return rejectWithValue(error === null || error === void 0 ? void 0 : (_error$resposne = error.resposne) === null || _error$resposne === void 0 ? void 0 : _error$resposne.message);\n  }\n}); //==================================================================================\n//slice\n\nconst postSlice = createSlice({\n  name: 'post',\n  initialState: {},\n  extraReducers: builder => {\n    builder.addCase(createPostAction.pending, (state, action) => {\n      state.loading = true;\n    });\n    builder.addCase(resetPost, (state, action) => {\n      state.isCreated = true;\n    });\n    builder.addCase(createPostAction.fulfilled, (state, action) => {\n      state.loading = false;\n      state.postCreated = action === null || action === void 0 ? void 0 : action.payload; //  state.isCreated=false;\n\n      state.appErr = undefined;\n      state.serverErr = undefined;\n    });\n    builder.addCase(createPostAction.rejected, (state, action) => {\n      var _action$payload, _action$error;\n\n      state.loading = false;\n      state.appErr = action === null || action === void 0 ? void 0 : (_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.message;\n      state.serverErr = action === null || action === void 0 ? void 0 : (_action$error = action.error) === null || _action$error === void 0 ? void 0 : _action$error.message;\n    });\n  }\n});\nexport default postSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","createAction","axios","baseUrl","createPostAction","post","rejectWithValue","getState","dispatch","user","users","userAuth","config","headers","Authorization","token","data","error","resposne","message","postSlice","name","initialState","extraReducers","builder","addCase","pending","state","action","loading","resetPost","isCreated","fulfilled","postCreated","payload","appErr","undefined","serverErr","rejected","reducer"],"sources":["C:/Users/Apoorva/Desktop/udemy/blog-frontend/src/redux/slices/posts/postSlices.js"],"sourcesContent":["import {createAsyncThunk, createSlice , createAction} from '@reduxjs/toolkit'\r\nimport axios from 'axios';\r\nimport { baseUrl } from \"../../../utils/baseurl\";\r\n\r\n\r\n//reset/\r\n//const resetPost=createAction(\"category/reset\");\r\n//create post action \r\nexport const createPostAction= createAsyncThunk('post/created',\r\n async (post, { rejectWithValue, getState, dispatch})=>{\r\n\r\n //getuser token to be able to create post\r\n const user=getState()?.users;\r\n // console.log(user)\r\n const {userAuth}=user;\r\n // console.log(userAuth?.token); // got token in console. now pass it as header\r\n const config={\r\n   headers: {\r\n     Authorization:`Bearer ${userAuth?.token}`,\r\n   },\r\n };\r\n try{\r\n     //http call\r\n     const {data}= await axios.post(`${baseUrl}/api/posts`, post, config);\r\n     //dispatch action\r\n    // dispatch(resetPost);\r\n     return data;\r\n } catch(error){\r\n     if(!error?.resposne) throw error;\r\n    return rejectWithValue(error?.resposne?.message);\r\n } \r\n\r\n});\r\n\r\n//==================================================================================\r\n//slice\r\nconst postSlice= createSlice({\r\n    name:'post',\r\n    initialState:{},\r\n    extraReducers:builder=>{\r\nbuilder.addCase(createPostAction.pending, (state, action)=>{\r\n    state.loading=true;\r\n});\r\nbuilder.addCase(resetPost,(state,action)=>{\r\n    state.isCreated=true;\r\n});\r\nbuilder.addCase(createPostAction.fulfilled, (state, action)=>{\r\n    state.loading=false;\r\n    state.postCreated=action?.payload;\r\n  //  state.isCreated=false;\r\n    state.appErr=undefined;\r\n    state.serverErr=undefined;\r\n});\r\nbuilder.addCase(createPostAction.rejected, (state, action)=>{\r\n    state.loading=false;\r\n    state.appErr=action?.payload?.message;\r\n    state.serverErr=action?.error?.message;\r\n});\r\n    },\r\n});\r\n\r\nexport default postSlice.reducer;"],"mappings":"AAAA,SAAQA,gBAAR,EAA0BC,WAA1B,EAAwCC,YAAxC,QAA2D,kBAA3D;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,wBAAxB,C,CAGA;AACA;AACA;;AACA,OAAO,MAAMC,gBAAgB,GAAEL,gBAAgB,CAAC,cAAD,EAC9C,OAAOM,IAAP,WAAsD;EAAA;;EAAA,IAAzC;IAAEC,eAAF;IAAmBC,QAAnB;IAA6BC;EAA7B,CAAyC;EAEtD;EACA,MAAMC,IAAI,gBAACF,QAAQ,EAAT,8CAAC,UAAYG,KAAvB,CAHsD,CAItD;;EACA,MAAM;IAACC;EAAD,IAAWF,IAAjB,CALsD,CAMtD;;EACA,MAAMG,MAAM,GAAC;IACXC,OAAO,EAAE;MACPC,aAAa,EAAE,UAASH,QAAV,aAAUA,QAAV,uBAAUA,QAAQ,CAAEI,KAAM;IADjC;EADE,CAAb;;EAKA,IAAG;IACC;IACA,MAAM;MAACC;IAAD,IAAQ,MAAMd,KAAK,CAACG,IAAN,CAAY,GAAEF,OAAQ,YAAtB,EAAmCE,IAAnC,EAAyCO,MAAzC,CAApB,CAFD,CAGC;IACD;;IACC,OAAOI,IAAP;EACH,CAND,CAME,OAAMC,KAAN,EAAY;IAAA;;IACV,IAAG,EAACA,KAAD,aAACA,KAAD,eAACA,KAAK,CAAEC,QAAR,CAAH,EAAqB,MAAMD,KAAN;IACtB,OAAOX,eAAe,CAACW,KAAD,aAACA,KAAD,0CAACA,KAAK,CAAEC,QAAR,oDAAC,gBAAiBC,OAAlB,CAAtB;EACF;AAED,CAxB8C,CAAxC,C,CA0BP;AACA;;AACA,MAAMC,SAAS,GAAEpB,WAAW,CAAC;EACzBqB,IAAI,EAAC,MADoB;EAEzBC,YAAY,EAAC,EAFY;EAGzBC,aAAa,EAACC,OAAO,IAAE;IAC3BA,OAAO,CAACC,OAAR,CAAgBrB,gBAAgB,CAACsB,OAAjC,EAA0C,CAACC,KAAD,EAAQC,MAAR,KAAiB;MACvDD,KAAK,CAACE,OAAN,GAAc,IAAd;IACH,CAFD;IAGAL,OAAO,CAACC,OAAR,CAAgBK,SAAhB,EAA0B,CAACH,KAAD,EAAOC,MAAP,KAAgB;MACtCD,KAAK,CAACI,SAAN,GAAgB,IAAhB;IACH,CAFD;IAGAP,OAAO,CAACC,OAAR,CAAgBrB,gBAAgB,CAAC4B,SAAjC,EAA4C,CAACL,KAAD,EAAQC,MAAR,KAAiB;MACzDD,KAAK,CAACE,OAAN,GAAc,KAAd;MACAF,KAAK,CAACM,WAAN,GAAkBL,MAAlB,aAAkBA,MAAlB,uBAAkBA,MAAM,CAAEM,OAA1B,CAFyD,CAG3D;;MACEP,KAAK,CAACQ,MAAN,GAAaC,SAAb;MACAT,KAAK,CAACU,SAAN,GAAgBD,SAAhB;IACH,CAND;IAOAZ,OAAO,CAACC,OAAR,CAAgBrB,gBAAgB,CAACkC,QAAjC,EAA2C,CAACX,KAAD,EAAQC,MAAR,KAAiB;MAAA;;MACxDD,KAAK,CAACE,OAAN,GAAc,KAAd;MACAF,KAAK,CAACQ,MAAN,GAAaP,MAAb,aAAaA,MAAb,0CAAaA,MAAM,CAAEM,OAArB,oDAAa,gBAAiBf,OAA9B;MACAQ,KAAK,CAACU,SAAN,GAAgBT,MAAhB,aAAgBA,MAAhB,wCAAgBA,MAAM,CAAEX,KAAxB,kDAAgB,cAAeE,OAA/B;IACH,CAJD;EAKK;AAtBwB,CAAD,CAA5B;AAyBA,eAAeC,SAAS,CAACmB,OAAzB"},"metadata":{},"sourceType":"module"}