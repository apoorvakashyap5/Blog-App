{"ast":null,"code":"import { createAsyncThunk, createSlice, createAction } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { baseUrl } from \"../../../utils/baseurl\"; //reset/\n//const resetPost=createAction(\"category/reset\");\n//create post action \n\nexport const createPostAction = createAsyncThunk('post/created', async (post, _ref) => {\n  var _getState;\n\n  let {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = _ref;\n  const details = localStorage.getItem('userInfo');\n  post.user = details.id; //getuser token to be able to create post\n\n  const user = (_getState = getState()) === null || _getState === void 0 ? void 0 : _getState.userInfo;\n  console.log(user);\n  const {\n    userAuth\n  } = user;\n  console.log(userAuth === null || userAuth === void 0 ? void 0 : userAuth.token); // got token in console. now pass it as header\n\n  const config = {\n    headers: {\n      Authorization: `Bearer ${userAuth === null || userAuth === void 0 ? void 0 : userAuth.token}`\n    }\n  };\n\n  try {\n    console.log(post); //http call\n\n    const {\n      data\n    } = await axios.post(`${baseUrl}/api/posts`, post, config); //dispatch action, config\n    // dispatch(resetPost);\n\n    return data;\n  } catch (error) {\n    var _error$resposne;\n\n    if (!(error !== null && error !== void 0 && error.resposne)) throw error;\n    return rejectWithValue(error === null || error === void 0 ? void 0 : (_error$resposne = error.resposne) === null || _error$resposne === void 0 ? void 0 : _error$resposne.message);\n  }\n}); //==================================================================================\n//slice\n\nconst postSlice = createSlice({\n  name: 'post',\n  initialState: {},\n  extraReducers: builder => {\n    builder.addCase(createPostAction.pending, (state, action) => {\n      state.loading = true;\n    }); //builder.addCase(resetPost,(state,action)=>{\n    //    state.isCreated=true;\n    //});\n\n    builder.addCase(createPostAction.fulfilled, (state, action) => {\n      state.loading = false;\n      state.postCreated = action === null || action === void 0 ? void 0 : action.payload; //  state.isCreated=false;\n\n      state.appErr = undefined;\n      state.serverErr = undefined;\n    });\n    builder.addCase(createPostAction.rejected, (state, action) => {\n      var _action$payload, _action$error;\n\n      state.loading = false;\n      state.appErr = action === null || action === void 0 ? void 0 : (_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.message;\n      state.serverErr = action === null || action === void 0 ? void 0 : (_action$error = action.error) === null || _action$error === void 0 ? void 0 : _action$error.message;\n    });\n  }\n});\nexport default postSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","createAction","axios","baseUrl","createPostAction","post","rejectWithValue","getState","dispatch","details","localStorage","getItem","user","id","userInfo","console","log","userAuth","token","config","headers","Authorization","data","error","resposne","message","postSlice","name","initialState","extraReducers","builder","addCase","pending","state","action","loading","fulfilled","postCreated","payload","appErr","undefined","serverErr","rejected","reducer"],"sources":["C:/Users/Apoorva/Desktop/udemy/blog-frontend/src/redux/slices/posts/postSlices.js"],"sourcesContent":["import {createAsyncThunk, createSlice , createAction} from '@reduxjs/toolkit'\r\nimport axios from 'axios';\r\nimport { baseUrl } from \"../../../utils/baseurl\";\r\n\r\n\r\n//reset/\r\n//const resetPost=createAction(\"category/reset\");\r\n//create post action \r\nexport const createPostAction= createAsyncThunk('post/created',\r\n async (post, { rejectWithValue, getState, dispatch})=>{\r\n const details=localStorage.getItem('userInfo');\r\n post.user=details.id;\r\n //getuser token to be able to create post\r\n const user=getState()?.userInfo;\r\n  console.log(user)\r\n const {userAuth}=user;\r\n  console.log(userAuth?.token); // got token in console. now pass it as header\r\n const config={\r\n   headers: {\r\n     Authorization:`Bearer ${userAuth?.token}`,\r\n   },\r\n };\r\n\r\n try{\r\n     console.log(post);\r\n     //http call\r\n     const {data}= await axios.post(`${baseUrl}/api/posts`, post, config);\r\n     //dispatch action, config\r\n    // dispatch(resetPost);\r\n     return data;\r\n } catch(error){\r\n     if(!error?.resposne) throw error;\r\n    return rejectWithValue(error?.resposne?.message);\r\n } \r\n\r\n});\r\n\r\n//==================================================================================\r\n//slice\r\nconst postSlice= createSlice({\r\n    name:'post',\r\n    initialState:{},\r\n    extraReducers:builder=>{\r\nbuilder.addCase(createPostAction.pending, (state, action)=>{\r\n    state.loading=true;\r\n});\r\n//builder.addCase(resetPost,(state,action)=>{\r\n//    state.isCreated=true;\r\n//});\r\nbuilder.addCase(createPostAction.fulfilled, (state, action)=>{\r\n    state.loading=false;\r\n    state.postCreated=action?.payload;\r\n  //  state.isCreated=false;\r\n    state.appErr=undefined;\r\n    state.serverErr=undefined;\r\n});\r\nbuilder.addCase(createPostAction.rejected, (state, action)=>{\r\n    state.loading=false;\r\n    state.appErr=action?.payload?.message;\r\n    state.serverErr=action?.error?.message;\r\n});\r\n    },\r\n});\r\n\r\nexport default postSlice.reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}