{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { baseUrl } from \"../../../utils/baseurl\"; //--------------------------------------------------------------------------------------------------------\n//register action : \n//thunk created\n\nexport const registerUserAction = createAsyncThunk(\"users/register\", //action type\nasync (user, _ref) => {\n  let {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = _ref;\n\n  //user is the payload\n  //rejectedwithValue-- helps us give exact error to the user\n  //getState---- gives us a snapshot of what is in our entire state\n  //dispatch-----helps dispatch another action inside this action\n  try {\n    //http call\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    const {\n      data\n    } = await axios.post( //api end-point\n    `${baseUrl}/api/users/register`, //payload:things we need to be able to register a user\n    user, //config\n    config);\n    return data;\n  } catch (error) {\n    var _error$response;\n\n    if (!(error !== null && error !== void 0 && error.response)) {\n      throw error;\n    }\n\n    return rejectWithValue(error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n  }\n}); //----------------------------------------------------------------------------------------------------------\n//login----------------------------------\n\nexport const loginUserAction = createAsyncThunk(\"user/login\", async (userData, _ref2) => {\n  let {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = _ref2;\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  };\n\n  try {\n    //make http call\n    const {\n      data\n    } = await axios.post(`${baseUrl}/api/users/login`, userData, config); //save user into local storage\n\n    localStorage.setItem(\"userInfo\", JSON.stringify(data));\n    return data;\n  } catch (error) {\n    var _error$response2;\n\n    if (!(error !== null && error !== void 0 && error.response)) {\n      throw error;\n    }\n\n    return rejectWithValue(error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data);\n  }\n}); //================================================================\n//LOGOUT action\n\nexport const logoutAction = createAsyncThunk('user/logout', async (payload, _ref3) => {\n  let {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = _ref3;\n\n  try {\n    localStorage.removeItem('userInfo');\n  } catch (error) {\n    var _error$response3;\n\n    if (!(error !== null && error !== void 0 && error.response)) {\n      throw error;\n    }\n\n    return rejectWithValue(error === null || error === void 0 ? void 0 : (_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data);\n  }\n}); //=================================================================\n//get user from localStorage and provide to initialState\n\nconst userLoginFromStorage = localStorage.getItem('userInfo') ? JSON.parse(localStorage.getItem('userInfo')) : null; //------------------------------------------------------------------------------------------------------------------------\n//register\n//createslices gives reducers and actionCreators both\n\nconst usersSlices = createSlice({\n  name: \"users\",\n  //reducer needs a state\n  initialState: {\n    userAuth: userLoginFromStorage\n  },\n  //object notation\n  extraReducers: builder => {\n    //register\n    builder.addCase(registerUserAction.pending, (state, action) => {\n      state.loading = true;\n    });\n    builder.addCase(registerUserAction.fulfilled, (state, action) => {\n      state.loading = false;\n      state.registered = action === null || action === void 0 ? void 0 : action.payload;\n      state.appErr = undefined; //since successful\n\n      state.serverErr = undefined;\n    });\n    builder.addCase(registerUserAction.rejected, (state, action) => {\n      var _action$payload, _action$error;\n\n      state.loading = false;\n      state.appErr = action === null || action === void 0 ? void 0 : (_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.message; //sice failed\n\n      state.serverErr = action === null || action === void 0 ? void 0 : (_action$error = action.error) === null || _action$error === void 0 ? void 0 : _action$error.message;\n    }); //----------------------===========================------------------------------------\n    //login slices\n\n    builder.addCase(loginUserAction.pending, (state, action) => {\n      state.loading = true;\n      state.appErr = undefined;\n      state.serverErr = undefined;\n    });\n    builder.addCase(loginUserAction.fulfilled, (state, action) => {\n      state.userAuth = action === null || action === void 0 ? void 0 : action.payload;\n      state.loading = false;\n      state.appErr = undefined;\n      state.serverErr = undefined;\n    });\n    builder.addCase(loginUserAction.rejected, (state, action) => {\n      var _action$payload2, _action$error2;\n\n      state.appErr = action === null || action === void 0 ? void 0 : (_action$payload2 = action.payload) === null || _action$payload2 === void 0 ? void 0 : _action$payload2.message;\n      state.serverErr = action === null || action === void 0 ? void 0 : (_action$error2 = action.error) === null || _action$error2 === void 0 ? void 0 : _action$error2.message;\n      state.loading = false;\n    }); //-------------------------------------------============================\n    //logout slices\n\n    builder.addCase(loginUserAction.pending, (state, action) => {\n      state.loading = false;\n    });\n    builder.addCase(loginUserAction.fulfilled, (state, action) => {\n      state.userAuth = undefined;\n      state.loading = false;\n      state.appErr = undefined;\n      state.serverErr = undefined;\n    });\n    builder.addCase(loginUserAction.rejected, (state, action) => {\n      var _action$pay, _action$error3;\n\n      state.loading = false;\n      state.appErr = action === null || action === void 0 ? void 0 : (_action$pay = action.pay) === null || _action$pay === void 0 ? void 0 : _action$pay.message;\n      state.serverErr = action === null || action === void 0 ? void 0 : (_action$error3 = action.error) === null || _action$error3 === void 0 ? void 0 : _action$error3.message;\n    });\n  }\n});\nexport default usersSlices.reducer; //for createAsyncThunk any action you create it gives:\n//1. pending\n//2.fulfilled\n//3.rejected","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","baseUrl","registerUserAction","user","rejectWithValue","getState","dispatch","config","headers","data","post","error","response","loginUserAction","userData","localStorage","setItem","JSON","stringify","logoutAction","payload","removeItem","userLoginFromStorage","getItem","parse","usersSlices","name","initialState","userAuth","extraReducers","builder","addCase","pending","state","action","loading","fulfilled","registered","appErr","undefined","serverErr","rejected","message","pay","reducer"],"sources":["C:/Users/Apoorva/Desktop/udemy/blog-frontend/src/redux/slices/users/usersSlices.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\nimport { baseUrl } from \"../../../utils/baseurl\";\r\n//--------------------------------------------------------------------------------------------------------\r\n//register action : \r\n//thunk created\r\nexport const registerUserAction = createAsyncThunk(\r\n  \"users/register\", //action type\r\n  async (user, { rejectWithValue, getState, dispatch }) => {\r\n    //user is the payload\r\n      //rejectedwithValue-- helps us give exact error to the user\r\n      //getState---- gives us a snapshot of what is in our entire state\r\n      //dispatch-----helps dispatch another action inside this action\r\n    try {\r\n      //http call\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      };\r\n      const { data } = await axios.post(\r\n          //api end-point\r\n        `${baseUrl}/api/users/register`,\r\n        //payload:things we need to be able to register a user\r\n        user,\r\n        //config\r\n        config\r\n      );\r\n      return data;\r\n    } catch (error) {\r\n      if (!error?.response) {\r\n        throw error;\r\n      }\r\n      return rejectWithValue(error?.response?.data);\r\n    }\r\n  }\r\n);\r\n\r\n//----------------------------------------------------------------------------------------------------------\r\n//login----------------------------------\r\nexport const loginUserAction = createAsyncThunk(\r\n  \"user/login\",\r\n  async (userData, { rejectWithValue, getState, dispatch }) => {\r\n    const config = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    };\r\n    try {\r\n      //make http call\r\n      const { data } = await axios.post(\r\n        `${baseUrl}/api/users/login`,\r\n        userData,\r\n        config\r\n      );\r\n      //save user into local storage\r\n      localStorage.setItem(\"userInfo\", JSON.stringify(data));\r\n      return data;\r\n    } catch (error) {\r\n      if (!error?.response) {\r\n        throw error;\r\n      }\r\n      return rejectWithValue(error?.response?.data);\r\n    }\r\n  }\r\n);\r\n//================================================================\r\n//LOGOUT action\r\nexport const logoutAction=createAsyncThunk(\r\n  'user/logout',\r\n  async (payload, { rejectWithValue, getState, dispatch}) => {\r\n    try{\r\n     localStorage.removeItem('userInfo')\r\n    }\r\n    catch(error){\r\n      if(!error?.response){\r\n        throw error;\r\n      }\r\n      return rejectWithValue(error?.response?.data);\r\n    }\r\n  }\r\n);\r\n\r\n//=================================================================\r\n//get user from localStorage and provide to initialState\r\nconst userLoginFromStorage =localStorage.getItem('userInfo')?JSON.parse(localStorage.getItem('userInfo')):null;\r\n\r\n//------------------------------------------------------------------------------------------------------------------------\r\n//register\r\n//createslices gives reducers and actionCreators both\r\n\r\nconst usersSlices = createSlice({\r\n    name: \"users\",\r\n    //reducer needs a state\r\n    initialState: {\r\n      userAuth: userLoginFromStorage,\r\n\r\n    },\r\n    //object notation\r\n    extraReducers: (builder) => {\r\n      //register\r\n    \r\n      builder.addCase(registerUserAction.pending, (state, action) => {\r\n        state.loading = true;\r\n      });\r\n      builder.addCase(registerUserAction.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.registered = action?.payload;\r\n        state.appErr = undefined; //since successful\r\n        state.serverErr = undefined;\r\n      });\r\n      builder.addCase(registerUserAction.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.appErr = action?.payload?.message; //sice failed\r\n        state.serverErr = action?.error?.message;\r\n      });\r\n\r\n      //----------------------===========================------------------------------------\r\n      //login slices\r\n      builder.addCase(loginUserAction.pending, (state, action) => {\r\n        state.loading=true;\r\n        state.appErr=undefined;\r\n        state.serverErr=undefined;\r\n      });\r\n      builder.addCase(loginUserAction.fulfilled, (state, action) => {\r\n        state.userAuth=action?.payload;\r\n        state.loading=false;\r\n        state.appErr=undefined;\r\n        state.serverErr=undefined;\r\n      });\r\n      builder.addCase(loginUserAction.rejected,(state, action)=>{\r\n        state.appErr=action?.payload?.message;\r\n        state.serverErr=action?.error?.message;\r\n        state.loading=false;\r\n      });\r\n\r\n      //-------------------------------------------============================\r\n      //logout slices\r\n      builder.addCase(loginUserAction.pending, (state, action)=>{\r\n        state.loading=false;\r\n      });\r\n      builder.addCase(loginUserAction.fulfilled, (state, action)=>{\r\n        state.userAuth=undefined;state.loading=false;\r\n        state.appErr=undefined;state.serverErr=undefined;\r\n      });\r\n      builder.addCase(loginUserAction.rejected, (state, action)=>{\r\n        state.loading=false;\r\n        state.appErr=action?.pay?.message;\r\n        state.serverErr=action?.error?.message;\r\n      })\r\n    },\r\n  });\r\n  \r\n  export default usersSlices.reducer;\r\n  \r\n\r\n  //for createAsyncThunk any action you create it gives:\r\n  //1. pending\r\n  //2.fulfilled\r\n  //3.rejected\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}